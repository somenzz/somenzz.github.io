(window.webpackJsonp=window.webpackJsonp||[]).push([[174],{743:function(s,t,a){"use strict";a.r(t);var n=a(7),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[a("a",{attrs:{href:"http://www.ityouknow.com/python/2020/01/02/python-pdf-107.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("用 Python 如何解析 PDF ，PDF 格式不像前面两个那么规范，从它的表现来看，它更像是一张图片，在一张白纸上把内容摆放在固定的位置上，没有逻辑结构。不过还是那句话，可以先了解下都能实现什么功能，以备不时之需。")]),s._v(" "),a("p",[s._v("正是因为 PDF 没有统一的规范，也没有逻辑结构，比如句子或段落，并且不能自适应页面大小的调整。今天要介绍的 PDFMiner 尝试通过猜测它们的布局来重建它们的结构，但是并不能保证一定能识别成功，尤其是对图片和表格的识别处理会差一些。")]),s._v(" "),a("h3",{attrs:{id:"安装-pdfminer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-pdfminer"}},[s._v("#")]),s._v(" 安装 PDFMiner")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("pip install pdfminer\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"解析概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解析概述"}},[s._v("#")]),s._v(" 解析概述")]),s._v(" "),a("p",[s._v("由于 PDF 文件有如此大和复杂的结构，完整解析 PDF 文件很费时费力的。因此 PDFMiner 采用了一个懒惰分析的策略，就是只分析你所需要的部分。换句话就是说，根据你自己的需要只解释出你要的那部分就可以了。这里有两个核心类是必须的 PDFParser 和 PDFDocument，除了这两个模块还有以下几个模块来配合使用。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNgy1gsncvhe567j30uw0ewabq.jpg",alt:""}})]),s._v(" "),a("p",[s._v("下面这个图表示了 PDFMiner 各模块之间的关系，让我们能有个基本的认识：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNgy1gsnd1k3j70j30cg09lt8r.jpg",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"解析示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解析示例"}},[s._v("#")]),s._v(" 解析示例")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pdfminer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pdfparser "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PDFParser\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pdfminer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pdfdocument "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PDFDocument\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pdfminer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pdfpage "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PDFPage\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pdfminer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pdfpage "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PDFTextExtractionNotAllowed\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pdfminer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pdfinterp "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PDFResourceManager\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pdfminer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pdfinterp "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PDFPageInterpreter\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pdfminer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pdfdevice "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PDFDevice\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pdfminer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("layout "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pdfminer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("converter "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PDFPageAggregator\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提供初始密码")]),s._v("\npassword "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 没有密码可以初始密码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# document.initialize()")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#打开pdf文件")]),s._v("\nfp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Python自动化办公实战.docx.pdf'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rb'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#从文件句柄创建一个pdf解析对象")]),s._v("\nparser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PDFParser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建pdf文档对象，存储文档结构")]),s._v("\ndocument "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PDFDocument"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建一个pdf资源管理对象，存储共享资源")]),s._v("\nrsrcmgr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PDFResourceManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nlaparams "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" LAParams"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建一个device对象")]),s._v("\ndevice "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PDFPageAggregator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rsrcmgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" laparams"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("laparams"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建一个解释对象")]),s._v("\ninterpreter "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PDFPageInterpreter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rsrcmgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" device"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#处理包含在文档中的每一页")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" page "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" PDFPage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("create_pages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    interpreter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("process_page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    layout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" device"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" x "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" layout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取文本对象")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("isinstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LTTextBox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("strip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取图片对象")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("isinstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("LTImage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'这里获取到一张图片'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取 figure 对象")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("isinstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("LTFigure"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'这里获取到一个 figure 对象'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br")])]),a("p",[s._v("OK，这次我们把 pdf 文件加载到内存后，循环加载到每个页面对象，并遍历各个对象，使用 isinstance 方法判断对象的类型，将文本对象时直接打印出来，当为其他对象时打印提示信息，上述代码运行结果如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNgy1gsnda320qoj318w0po41e.jpg",alt:""}})]),s._v(" "),a("p",[s._v("可以看出 PDFMiner 对文本的解析还是不错的，不过对图片的解析，正如官方文档所说，识别并不是很准确，这里将图片识别为了 figure 对象。另外对于表格的支持也不够好，虽然能读取出来表格内容，但完全看不出表格的样式来，后期还需要进一步处理。")]),s._v(" "),a("p",[s._v("其他学习资源：")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://euske.github.io/pdfminer/",target:"_blank",rel:"noopener noreferrer"}},[s._v("python-pdfminer 官网"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/euske/pdfminer",target:"_blank",rel:"noopener noreferrer"}},[s._v("Python PDF Parser"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1395339",target:"_blank",rel:"noopener noreferrer"}},[s._v("三大神器助力Python提取pdf文档信息"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);