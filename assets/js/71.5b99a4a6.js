(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{440:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("最近，我使用 GitHub Actions 实现了静态博客的自动化部署，觉得它非常强大，也就是说，只要你提交到 GitHub，后面的部署完全由 GitHub 替你完成。")]),s._v(" "),a("p",[s._v("其实不止博客的部署，任意软件的持续集成，都可以由 GitHub Actions 来完成，比如拉取代码、运行测试、登录远程服务器，发布到第三方服务等。因此 GitHub Actions 是实现自动化发布最便捷的方式了，值得学习和使用。")]),s._v(" "),a("p",[s._v("接下来，我以 GitHub Actions 实现静态博客的自动化部署为例，带你入门 GitHub Actions，如有任何问题，欢迎留言讨论。")]),s._v(" "),a("p",[s._v("很多程序员都有自己的博客，而静态博客是学习成本和部署成本都非常低，也无需担心网站安全问题，可以专心写博客。")]),s._v(" "),a("p",[s._v("所谓静态博客，即通过生成工具（eg：Hexo、Hugo、VuePress 等），直接将作者所书写的博文编译成最终的 html、css、js 等静态文件。然后只需将生成的文件部署在服务器（eg：GitHub、Gitee、自建服务器）上面即可被在互联网中访问。")]),s._v(" "),a("p",[s._v("一般这类静态博客部署的流程是：")]),s._v(" "),a("ol",[a("li",[s._v("写一篇 markdown 文章。")]),s._v(" "),a("li",[s._v("执行命令生成静态文件，比如 "),a("code",[s._v("npm run build")]),s._v("。")]),s._v(" "),a("li",[s._v("将静态文件推送到博客仓库，比如说 GitHub、Gitee 或者服务器，如果是 Gitee，还要手动点击重新部署按钮。")]),s._v(" "),a("li",[s._v("访问网址验证是否成功")]),s._v(" "),a("li",[s._v("为了备份你的博客，你可能要将你写博客的项目也推送到仓库。")])]),s._v(" "),a("p",[s._v("博客就是用来写文章的，每次写篇文章还要搞这么多操作，时间长了你一定会觉得很累。虽然可以写成脚本，但是迁移成本比较高。")]),s._v(" "),a("p",[s._v("现在，这个问题不存在了，当你使用了 GitHub Actions 之后，流程可以简化为：")]),s._v(" "),a("ol",[a("li",[s._v("写一篇 markdown 文章。")]),s._v(" "),a("li",[s._v("提交到 GitHub。这一步相当于上面的第 5 步，不需要上传 node_modules 文件夹。")])]),s._v(" "),a("p",[s._v("结束了，是不是很方便？")]),s._v(" "),a("p",[s._v("即使自己写博客的电脑不在身边，只要有网络可以将这个写博客的仓库 clone 下，写完 push 一下就可以了，完全不用安装任何脚手架及如黑洞般的 node_modules，让你随时随地的写博客。")]),s._v(" "),a("p",[s._v("从机械的流程中解脱，专注于写作，岂不美哉！那么现在就开始 GitHub Actions 之旅吧。")]),s._v(" "),a("h2",{attrs:{id:"先定一个小目标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#先定一个小目标"}},[s._v("#")]),s._v(" 先定一个小目标")]),s._v(" "),a("p",[s._v("假如有以下四个仓库：")]),s._v(" "),a("ol",[a("li",[s._v("git@github.com:somenzz/push_blog：写博客的项目仓库，里面有用于生成博客的 md 文件，和生成静态博客的脚手架，比如 VuePress，hexo 等，该仓库可以私有。")]),s._v(" "),a("li",[s._v("git@github.com:somenzz/somenzz.github.io：存放博客的静态资源文件，用于 GitHub Pages 展示博客，必须开源。")]),s._v(" "),a("li",[s._v("git@gitee.com/somenzz/somenzz：存放博客的静态资源文件，用于 GitHub Pages 展示博客，必须开源。")]),s._v(" "),a("li",[s._v("ip 地址：xxx.xxx.xxx.xxx，或者域名 somenzz.cn，路径 /xxxx/public/，是自己购买的服务器，用于存放静态博客资源文件。")])]),s._v(" "),a("p",[s._v("现在的目标就是，写好一篇文章，向仓库 1 推送之后，仓库 2、3、4 自动更新静态资源文件。当然了，你也可以根据自己情况，选择性的更新其中一个或多个，只需要将对应的步骤从 GitHub Actions 配置中注释或删除即可。")]),s._v(" "),a("h2",{attrs:{id:"理解-github-actions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#理解-github-actions"}},[s._v("#")]),s._v(" 理解 GitHub Actions")]),s._v(" "),a("p",[s._v("这里说下我对 Github Actions 的理解，你提交到仓库 1 后，GitHub 会监控到，然后分配一天虚拟机先将你的项目 clone 过去，然后按照你指定的 step 顺序执行你定义的 action，这些 actions 就包括 "),a("code",[s._v("npm run build")]),s._v(" 生成静态文件，push 到你指定的仓库。")]),s._v(" "),a("p",[s._v("这期间就涉及一些访问权限的控制，你要向 GitHub 证明你对这些仓库有控制权限，有些操作，还需要你提供 RSA 的私钥，登录的口令，当然了，这些口令都是加密存放的，不会泄漏。")]),s._v(" "),a("p",[s._v("为了实现上面的小目标，我们要让 GitHub 替我们做的事情如下：")]),s._v(" "),a("ol",[a("li",[s._v("编译项目。也就是仓库 1: git@github.com:somenzz/push_blog，生成博客的静态资源。")]),s._v(" "),a("li",[s._v("将静态资源 push 到 GitHub，也就是仓库 2: git@github.com:somenzz/somenzz.github.io，这一步完成后 GitHub Pages 就部署完成了。")]),s._v(" "),a("li",[s._v("将仓库 2 同步给仓库 3，也就是 git@github.com:somenzz/somenzz.github.io 同步给 git@gitee.com/somenzz/somenzz，这样两个项目的静态资源就一致了。")]),s._v(" "),a("li",[s._v("部署 Gitee Pages，因为 Gitee 的限制，本来需要手动点一下的，现在我们变成一个 GitHub action。")]),s._v(" "),a("li",[s._v("使用 rsync 增量同步工具，将静态资源同步的自购服务器的对应目录上。")])]),s._v(" "),a("h2",{attrs:{id:"一步一步跟我操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一步一步跟我操作"}},[s._v("#")]),s._v(" 一步一步跟我操作")]),s._v(" "),a("p",[s._v("现在，我们一步一步来。")]),s._v(" "),a("p",[s._v("首先在仓库 1 的根目录下，创建 "),a("code",[s._v(".github/workflows/main.yml")]),s._v(" 文件，这就是 GitHub Actions 功能的配置文件，用于告诉 GitHub 要做哪些事情，写入以下内容")]),s._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deploy GitHub Pages\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 触发条件：在 push 到 master 分支后")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branches")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" master\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 任务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build-and-deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务器环境：最新版 Ubuntu")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runs-on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("latest\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("steps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拉取代码")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Checkout\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/checkout@v2\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("persist-credentials")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成静态文件")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Build\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" npm install && npm run build\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署到 GitHub Pages")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deploy\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" JamesIves/github"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("action@releases/v3\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ACCESS_TOKEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.ACCESS_TOKEN "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("REPOSITORY_NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" somenzz/somenzz.github.io\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("BRANCH")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("FOLDER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" public  \n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#注意这里的 public 是仓库根目录下的 public，也就是 npm run build 生成静态资源的路径，比如有的人是 `docs/.vuepress/dist`")]),s._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同步到 gitee 的仓库")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Sync to Gitee\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wearerequired/git"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mirror"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("action@master\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意在 Settings->Secrets 配置 GITEE_RSA_PRIVATE_KEY")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("SSH_PRIVATE_KEY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.GITEE_RSA_PRIVATE_KEY "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意替换为你的 GitHub 源仓库地址")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("source-repo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" git@github.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("somenzz/somenzz.github.io.git\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意替换为你的 Gitee 目标仓库地址")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("destination-repo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" git@gitee.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("somenzz/somenzz.git\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署到 Gitee Pages")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Build Gitee Pages\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yanglbme/gitee"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("action@main\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意替换为你的 Gitee 用户名")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitee-username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" somenzz\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意在 Settings->Secrets 配置 GITEE_PASSWORD")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitee-password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.GITEE_PASSWORD "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意替换为你的 Gitee 仓库，仓库名严格区分大小写，请准确填写，否则会出错")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitee-repo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" somenzz/somenzz\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要部署的分支，默认是 master，若是其他分支，则需要指定（指定的分支必须存在）")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署到 somenzz.cn 服务器")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" rsync deployments\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" burnett01/rsync"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("deployments@4.1\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 这里是 rsync 的参数 switches: -avzh --delete --exclude="" --include="" --filter=""')]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("switches")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("avzh\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" public/\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("remote_path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /home/ubuntu/public/\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("remote_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" somenzz.cn\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("remote_port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("remote_user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("remote_key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.MY_UBUNTU_RSA_PRIVATE_KEY "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br")])]),a("p",[s._v("稍微有点长，为了便于你理解，每一步都有注释，这就是这次 Github Actions 配置文件的全部内容，遵循 YAML 格式，这里我做一个大致的说明：")]),s._v(" "),a("ul",[a("li",[s._v("on 表示触发条件")]),s._v(" "),a("li",[s._v("jobs 表示要做的工作")]),s._v(" "),a("li",[s._v("jobs 下的 step 表示要做的步骤，前一步失败，后面不会继续执行。")]),s._v(" "),a("li",[s._v("jobs 下的 step 下有 name、uses、with 等，表示一个 action。")]),s._v(" "),a("li",[s._v("name 表示 action 的名称，uses 表示使用哪个插件，with 表示传给插件的参数。")]),s._v(" "),a("li",[a("code",[s._v("secrets.XXX")]),s._v(" 这个 XXX 表示本仓库的环境变量，配置在仓库设置里面的 secrets 菜单拦，都是加密的。")])]),s._v(" "),a("p",[s._v("uses 中用的就是别人写好的插件，持续集成由很多操作组成，比如抓取代码、运行测试、登录远程服务器，发布到第三方服务等等，这些操作都用共性，GitHub 就允许其他人把写好的插件共享到插件市场供其他人使用。")]),s._v(" "),a("p",[s._v("如果你需要某个 action，不必自己写复杂的脚本，直接引用他人写好的 action 即可，你说方便不方便。")]),s._v(" "),a("p",[s._v("上述文件 "),a("code",[s._v(".github/workflows/main.yml")]),s._v(" 写好之后，先别着急 push，一旦 push，这些 actions 就会执行，参数没有正确的配置，报错那是肯定的。")]),s._v(" "),a("p",[s._v("接下来我说一下每一个参数的意义和如何确定这些参数的值。")]),s._v(" "),a("p",[s._v("1、secrets.ACCESS_TOKEN\n对应的配置代码：")]),s._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[s._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署到 GitHub Pages")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deploy\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" JamesIves/github"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("action@releases/v3\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ACCESS_TOKEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.ACCESS_TOKEN "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("REPOSITORY_NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" somenzz/somenzz.github.io\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("BRANCH")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("FOLDER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" public\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("这个 ACCESS_TOKEN 是访问 GitHub API 的令牌，可以在 GitHub 主页，点击个人头像，Settings -> Developer settings -> Personal access tokens 进行生成或更新，第一次生成后你可以看到这个令牌，然后再也不会显示，因此你需要记下来，假如这个字符串是 aaa，然后打开仓库 1 的设置页面，设置 secrets，加入环境变量 key 是 ACCESS_TOKEN，value 是 aaa。如下图所示：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gmzkfeqcwvj325y0u076a.jpg",alt:""}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gmzkjd71okj324m0u0gnx.jpg",alt:""}})])])}),[],!1,null,null,null);t.default=e.exports}}]);