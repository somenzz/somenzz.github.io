(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{620:function(t,s,a){"use strict";a.r(s);var n=a(7),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("上次写了用 Python 批量下载知乎视频的方式，这次分享用 Python 批量下载抖音个人主页的全部无水印视频，本文重点不是提供一个好用的脚本，而是讲述如何写出这样的脚本，正所谓授人以鱼，不如授人以渔，所谓的爬虫，基本都是这个套路。")]),t._v(" "),a("h3",{attrs:{id:"思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#思路"}},[t._v("#")]),t._v(" 思路")]),t._v(" "),a("p",[t._v("先说下思路，要批量下载视频，可以先尝试成功下载一个，确定没有水印，然后在写一个循环进行批量下载。")]),t._v(" "),a("p",[t._v("难点：下载一个视频可能很简单，但下载多个就稍微有点复杂，需要抓取多个视频对应的 url，抖音这块做了防爬措施，只允许手机上看到个人主页的视频列表，电脑端的网页却看不到，这就需要抓取手机的 https 包，这里借助 Burpsuite 进行抓包。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gnaq1czuxij31ap0u0abx.jpg",alt:""}})]),t._v(" "),a("p",[t._v("这里用到了 Burpsuite ，因此我把自己常用的 Burpsuite 2.1.06 专业版放在了网盘里面，公众号「Python七号」回复「burp」获取，下载后运行 "),a("code",[t._v("start_burp.bat")]),t._v(" 或 "),a("code",[t._v("sh start_burp.sh")]),t._v(" 即可一键启动，无需购买许可，非常方便。")]),t._v(" "),a("h3",{attrs:{id:"爬取单个视频"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#爬取单个视频"}},[t._v("#")]),t._v(" 爬取单个视频")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("找一个抖音视频链接，点击分享，复制链接，在电脑上用打开，然后打开开发者工具，点击 network 选项。")])]),t._v(" "),a("li",[a("p",[t._v("刷新，看接口，找到返回值里有播放地址的接口：")])])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gnb39mxuhaj31jk0u07ct.jpg",alt:""}})]),t._v(" "),a("p",[t._v("这里面有个 play_addr，内部有个 urllist，我们复制这个 urllist[0] 在浏览器打开，网站跳转到了真正的播放地址，同时可以看到下载的按钮：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gnb3ci4qrgj31530u0wku.jpg",alt:""}})]),t._v(" "),a("p",[t._v("下载这个视频，发现是带水印的，如何下载到不带水印的视频呢？ 网上搜索了下，方法就是将上述 urllist[0] 中的 playwm 改成 play 就可以了。")]),t._v(" "),a("p",[t._v("然后开始写代码，获取这个 urllist[0]，并下载")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("share_url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("dict")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v("\"\"\"\n    share_url -> 抖音视频分享url\n    返回格式 [{'url':'', 'title','format':'',},{}]\n    \"\"\"")]),t._v("\n    data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    headers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'accept'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user-agent'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    api "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.iesdouyin.com/web/api/v2/aweme/iteminfo/?item_ids={item_id}"')]),t._v("\n\n    rep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("share_url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" timeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ok"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# item_id")]),t._v("\n        item_id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" re"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("findall"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'video/(\\d+)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" item_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            item_id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" item_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# video info")]),t._v("\n            rep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item_id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("item_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" timeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ok "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("json"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status_code"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                info "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("json"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"item_list"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                tmp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                tmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"title"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"desc"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#去水印的视频链接")]),t._v("\n                play_url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"video"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"play_addr"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"url_list"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'playwm'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'play'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                tmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"url"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" play_url\n                tmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"format"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mp4'")]),t._v("\n                data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" data\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__main__'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    videos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://www.iesdouyin.com/share/video/6920538027345415431/?region=&mid=6920538030852885262&u_code=48&titleType=title&did=0&iid=0'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" video "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" videos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        downloader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("download"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("video"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'url'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("video"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'title'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("video"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'format'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./download'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br")])]),a("p",[t._v("这里 downloader.download 函数，与前文"),a("a",{attrs:{href:"https://mp.weixin.qq.com/s/kOnI-q2BLXkdqdCFzY6pnA",target:"_blank",rel:"noopener noreferrer"}},[t._v("知乎视频下载"),a("OutboundLink")],1),t._v(" 里的函数一样，这里就不贴代码了。")]),t._v(" "),a("h3",{attrs:{id:"获取个人主页视频链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取个人主页视频链接"}},[t._v("#")]),t._v(" 获取个人主页视频链接")]),t._v(" "),a("p",[t._v("前两步已经实现了单个抖音视频的无水印下载，现在我们要做的就是找到大量的这种链接，直接循环就可以了。")]),t._v(" "),a("p",[t._v("任意打开一个大 V 的个人主页，分享，复制链接，使用浏览器打开，一个视频也看不到，而使用抖音 App 就可以看到：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gnbv4i6b7sj30ly13egn3.jpg",alt:"浏览器"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gnbv53bcljj30ku11242i.jpg",alt:"抖音APP"}})]),t._v(" "),a("p",[t._v("说明抖音做了一定的限制，防止从浏览器看到多个视频的信息。这时就需要学会从手机 APP 来抓包，看看手机上的 http 请求是怎么发起的，然后使用程序来模拟。")]),t._v(" "),a("p",[t._v("我一直在用的 BurpSuite（下面简称 Burp） 非常好用，这里顺便分享下如何使用：")]),t._v(" "),a("p",[t._v("1、运行 Burp。")]),t._v(" "),a("p",[t._v("公众号「Python七号」回复「burp」获取，下载后运行 "),a("code",[t._v("start_burp.bat")]),t._v(" 或 "),a("code",[t._v("sh start_burp.sh")]),t._v(" 来启动 Burp，然后打开代理设置，绑定到运行 Burp 的机器 IP，如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gnc7dazaclj31ap0u0mzf.jpg",alt:""}})]),t._v(" "),a("p",[t._v("注意不要设置 ip 为 127.0.0.1，这样设置的话，只有本地请求可以使用代理，手机无法连接此代理。")]),t._v(" "),a("p",[t._v("2、手机设置代理。")]),t._v(" "),a("p",[t._v("手机与电脑连接同一 wifi，IPhone 的操作如下：然后进入设置-> 无线局域网 -> 点击同一 wifi 右边的 information 符号，然后下拉，点击配置代理，配置和 BurpSuite 一样的 ip 和端口。\nAndroid 的手机的设置也差不多。至此可以在 BurpSuite 上抓取手机的 http 流量。")]),t._v(" "),a("p",[t._v("3、手机下载 Burp 的证书，并设置信任。")]),t._v(" "),a("ol",[a("li",[t._v("手机浏览器 进入 http://burp。")]),t._v(" "),a("li",[t._v("点击 CA 下载证书。")]),t._v(" "),a("li",[t._v("设置->通用->描述文件->点击 PortSwigger CA->安装")]),t._v(" "),a("li",[t._v("设置->通用->关于本机->证书信任设置，将 BurpSuite 的证书开启")])]),t._v(" "),a("p",[t._v("这样就可以抓取手机上发起的 https 包了。")]),t._v(" "),a("p",[t._v("4、设置 BurpSuite 中断。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gnc7pkxb33j31d40oywez.jpg",alt:""}})]),t._v(" "),a("p",[t._v("这一步骤设置之后，手机上的请求会在这里阻塞，你可以放行选择放行，或修改数据包后放行，也可以发往 repeater，以便后续重放请求，因此来自前端的请求是不可信的。")]),t._v(" "),a("p",[t._v("现在打开手机上的抖音 App，这里便会出现大量的请求阻塞在这里，我们选择放行，会发现抖音 App 里的数据一步一步的出现。快刷到个人主页的视频前，将请求发到 repeater，如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gnc83fr5c9j31ap0u0n0x.jpg",alt:""}})]),t._v(" "),a("p",[t._v("然后打开 BurpSuite 的 Repeater 选项卡，就可以看到刚才发过来的请求，这时我们选择重放，看数据，决定我们需要使用的接口，如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gnc86vyqq1j31ap0u07c5.jpg",alt:""}})]),t._v(" "),a("p",[t._v("发现这个接口满足请求，这里可以看到接口的 url，headers 的各种参数，headers 中的 User-Agent 参数，是区分客户端是浏览器还是 App 的重要标识，因此就可以写代码来模拟请求，进而获取需要的批量下载链接。")]),t._v(" "),a("p",[t._v("由于 url 中的参数非常多，有些是固定不变的，有些随着不同人的主页参数会发生变化，如果仅仅是自己使用，可以简单的通过正则表达式来提取这些 url 链接，然后进行批量下载就可以了。")]),t._v(" "),a("p",[t._v("如果是想写好一个脚本供别人使用，那么就需要做更多的工作，比如说，需要查看更多的 api，以便确定 url 及 headers 中的参数是如何获取或生成的，然后写脚本自动化这一过程，有些情况下，还涉及到加密混淆等反爬措施，这里就不再展开了，请感兴趣的读者自行探索。")]),t._v(" "),a("h3",{attrs:{id:"最后的话"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最后的话"}},[t._v("#")]),t._v(" 最后的话")]),t._v(" "),a("p",[t._v("爬取视频的关键在于找到视频的播放地址，有了播放地址，即使不写代码，也可以使用浏览器下载，寻找播放地址还不够，要考虑是否能去水印，如果要批量下载，那就要知道如何获取更多的视频链接，在浏览器抓取不到的时候，考虑使用 BurpSuite 抓取手机的流量包，进一步提取接口的数据，或模拟手机请求，对搞爬虫的同学，BurpSuite 是一个瑞士军刀，非常实用。")]),t._v(" "),a("p",[t._v("如果本文对你有所帮助，请点个赞或再看吧，谢谢支持。")])])}),[],!1,null,null,null);s.default=r.exports}}]);