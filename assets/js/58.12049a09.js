(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{640:function(s,t,a){"use strict";a.r(t);var n=a(7),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("工作中，我们基本上都用过电子邮件的客户端，比如说 OutLook，Foxmail，从配置项可以知道，SMTP 协议用于发送邮件，POP3 和 IMAP 协议用于接收邮件。其实很多编程语言都有这类协议的实现，Python 自然也不例外，标准库 smtplib、poplib、imaplib 是对应协议的实现。")]),s._v(" "),a("p",[s._v("至于发送邮件，不推荐初学者使用 smtplib，推荐使用 djangomail，具体方法见前文"),a("a",{attrs:{href:"https://mp.weixin.qq.com/s/N2YZnTnoMP7RqYtGnEw7NA?scene=156&subScene=10008",target:"_blank",rel:"noopener noreferrer"}},[s._v("最简单的方式发送邮件，让程序出错自动发邮件"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("p",[s._v("今天分享如何使用 poplib、imaplib 来接收邮件。")]),s._v(" "),a("p",[s._v("你说这两个都可以用来收邮件，到底用哪一个呢？ 先看下他们的区别。")]),s._v(" "),a("h2",{attrs:{id:"pop3-与-imap-的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pop3-与-imap-的区别"}},[s._v("#")]),s._v(" POP3 与 IMAP 的区别")]),s._v(" "),a("p",[s._v("POP3 协议是 Post Office Protocol 3 的简称，即邮局协议的第 3 个版本，是 TCP/IP 协议族中的一员，默认端口是110。本协议主要用于支持使用客户端远程管理在服务器上的电子邮件。")]),s._v(" "),a("p",[s._v("IMAP 全称是 Internet Mail Access Protocol，即交互式邮件访问协议，是一个应用层协议，端口是 143。用来从本地邮件客户端访问远程服务器上的邮件。")]),s._v(" "),a("p",[s._v("POP3 工作在传输层，而 IMAP 工作中应用层，从这一点来看，IMAP 更为高级，事实上正是如此。虽然这两个协议都是从邮件服务器下载邮件到本地，但是不同的是 IMAP 提供双向通信，也即在客户端所作的更改会反馈给服务器端，跟服务器端形成同步，例如删除邮件，创建文件夹等。而 POP3 是单向通信的，即下载邮件到本地就算了，所作的更改都只是在客户端，不会反映到服务器端。所以使用 IMAP 协议也会更便捷，体验更好，更可靠。")]),s._v(" "),a("p",[s._v("因此，如果你希望对邮件的更改同步到服务端，那么使用 IMAP，否则使用 POP3")]),s._v(" "),a("h2",{attrs:{id:"pop3-发送邮件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pop3-发送邮件"}},[s._v("#")]),s._v(" POP3 发送邮件")]),s._v(" "),a("p",[s._v("以下面的代码为例，我们来获取最新的一封邮件内容：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" poplib\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" email"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parser "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Parser\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" utils "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" print_info\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" settings\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接到POP3服务器:")]),s._v("\nserver "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" poplib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("POP3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pop3_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 身份认证:")]),s._v("\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("email"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pass_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# stat()返回邮件数量和占用空间:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Messages: %s. Size: %s'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# list()返回所有邮件的编号:")]),s._v("\nresp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" octets "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以查看返回的列表类似[b'1 82923', b'2 2184', ...]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取最新一封邮件, 注意索引号从1开始:")]),s._v("\nlatest_mail_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nresp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lines"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" octets "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("retr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("latest_mail_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lines存储了邮件的原始文本的每一行,")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以获得整个邮件的原始文本:")]),s._v("\nmsg_content "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'\\r\\n'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lines"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf-8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 稍后解析出邮件:")]),s._v("\nmsg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Parser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parsestr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg_content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nprint_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 邮件索引号直接从服务器删除邮件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# server.dele(index)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭连接:")]),s._v("\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("quit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])]),a("p",[s._v("执行结果如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNgy1grja4816zoj31460pkjsg.jpg",alt:""}}),s._v("\npoplib 收取邮件分两步：第一步是获取邮件列表，第二步是用 email 模块把原始邮件解析为 Message 对象，然后，用适当的形式把邮件内容展示出来。print_info 函数的逻辑比较复杂，放在了 utils.py 中，完整代码见文末的链接。")]),s._v(" "),a("h2",{attrs:{id:"基于-poplib-的三方库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于-poplib-的三方库"}},[s._v("#")]),s._v(" 基于 poplib 的三方库")]),s._v(" "),a("p",[s._v("使用完标准库 poplib，也使用过三方库 zmail，我只想说，还是三方库用起来爽。")]),s._v(" "),a("h4",{attrs:{id:"zmail"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zmail"}},[s._v("#")]),s._v(" zmail")]),s._v(" "),a("p",[s._v("Zmail 使得在 Python3 中发送和接受邮件变得更简单。你不需要手动添加服务器地址、端口以及适合的协议，zmail 会帮你完成。此外，使用一个字典来代表邮件内容也更符合直觉。")]),s._v(" "),a("p",[s._v("Zmail 仅支持 Python3，不依赖任何三方库。安装方法：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" zmail\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("特性：")]),s._v(" "),a("ul",[a("li",[s._v("自动寻找服务器地址以及端口")]),s._v(" "),a("li",[s._v("自动使用可靠的链接协议")]),s._v(" "),a("li",[s._v("自动将一个python字典映射成MIME对象（带有附件的）")]),s._v(" "),a("li",[s._v("自动添加头文件以及localhostname来避免服务器拒收你的邮件")]),s._v(" "),a("li",[s._v("轻松自定义你的头文件")]),s._v(" "),a("li",[s._v("支持使用HTML作为邮件内容")]),s._v(" "),a("li",[s._v("仅需 python>=3.5，你可以将其嵌入你的项目而无需其他的依赖")])]),s._v(" "),a("p",[s._v("示例代码：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" zmail\nserver "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" zmail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yourmail@example.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yourpassword'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Send mail")]),s._v("\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("send_mail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yourfriend@example.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'subject'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'content_text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'By zmail.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Or to a list of friends.")]),s._v("\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("send_mail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'friend1@example.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'friend2@example.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'subject'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'content_text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'By zmail.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Retrieve mail")]),s._v("\nlatest_mail "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_latest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nzmail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("latest_mail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("可以看出，接收最新的邮件只需要两行代码：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("latest_mail "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_latest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nzmail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("latest_mail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("执行结果如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNgy1grja9kgu2gj313q0kcdi3.jpg",alt:""}})]),s._v(" "),a("p",[s._v("很简洁，很好用。")]),s._v(" "),a("p",[s._v("文档：https://github.com/zhangyunhao116/zmail/blob/master/README-cn.md")]),s._v(" "),a("h2",{attrs:{id:"imap-接收邮件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#imap-接收邮件"}},[s._v("#")]),s._v(" imap 接收邮件")]),s._v(" "),a("p",[s._v("很多主流邮箱如 163，qq 邮箱默认关闭了 imap 的服务，可手动前往邮箱账户设置页面开启，并生成授权码，授权码就是代码中用于登录的密码。")]),s._v(" "),a("p",[s._v("获取最新的邮件并展示：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" imaplib\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" email  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#导入两个库")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" settings\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" utils "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" print_info\n\nM "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" imaplib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("IMAP4_SSL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("host "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("imap_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'已连接服务器'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("login"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("email"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'已登陆'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("noop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("select"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\ntyp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("search"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ALL'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    typ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fetch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(RFC822)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print('Message %s\\n%s\\n' % (num, data[0][1]))")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print(data[0][1].decode('utf-8'))")]),s._v("\n    msg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" email"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("message_from_string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf-8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    print_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),s._v("\nM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("logout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("运行结果如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/008i3skNgy1grjac4sxqhj31460e60tc.jpg",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"基于-imaplib-的三方库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于-imaplib-的三方库"}},[s._v("#")]),s._v(" 基于 imaplib 的三方库")]),s._v(" "),a("p",[s._v("你可能会问：为什么要为 Python 创建另一个 IMAP 客户端库？Python 标准库不是已经有 imaplib 了吗？。")]),s._v(" "),a("p",[s._v("imaplib 的问题在于它非常底层。 使用起来相当复杂，你可能需要处理很多细节问题，由于 IMAP 服务器响应可能非常复杂，这意味着使用 imaplib 的每个人最终都会编写自己的脆弱解析程序。")]),s._v(" "),a("p",[s._v("此外，imaplib 没有很好地利用异常。 这意味着您需要检查 imaplib 的每次调用的返回值，以查看请求是否成功。下面推荐两个常用的三方库。")]),s._v(" "),a("h4",{attrs:{id:"imapclient"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#imapclient"}},[s._v("#")]),s._v(" imapclient")]),s._v(" "),a("p",[s._v("imapclient 在内部使用的 imaplib，但比 imaplib 好用的多，示例代码如下：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" ssl\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" imapclient "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" IMAPClient\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" settings\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# context manager ensures the session is cleaned up")]),s._v("\n\n\nssl_context "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ssl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("create_default_context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# don't check if certificate hostname doesn't match target hostname")]),s._v("\nssl_context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("check_hostname "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# don't check if the certificate is trusted by a certificate authority")]),s._v("\nssl_context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("verify_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ssl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CERT_NONE\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" IMAPClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("host"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("imap_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("ssl_context"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ssl_context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("login"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("account"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    select_info "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("select_folder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'INBOX'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%d messages in INBOX'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" select_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'EXISTS'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# search criteria are passed in a straightforward way")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (nesting is supported)")]),s._v("\n    messages "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("search"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'FROM'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxx@163.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# `response` is keyed by message id and contains parsed,")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# converted response items.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" message_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fetch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("messages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ENVELOPE'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("items"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        envelope "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'ENVELOPE'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{id}: subject: {subject} date: {date}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("message_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            subject "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" envelope"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" envelope"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("date\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("p",[s._v("文档： https://github.com/mjs/imapclient")]),s._v(" "),a("h4",{attrs:{id:"imap-tools"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#imap-tools"}},[s._v("#")]),s._v(" imap_tools")]),s._v(" "),a("p",[s._v("通过 IMAP 处理电子邮件和邮箱，支持以下功能：")]),s._v(" "),a("ul",[a("li",[s._v("解析的电子邮件消息属性")]),s._v(" "),a("li",[s._v("用于搜索电子邮件的查询生成器")]),s._v(" "),a("li",[s._v("使用电子邮件的操作：复制、删除、标记、移动、看到、追加")]),s._v(" "),a("li",[s._v("使用文件夹的操作：列表、设置、获取、创建、存在、重命名、删除、状态")]),s._v(" "),a("li",[s._v("没有依赖项")])]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("pip install imap"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tools\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例代码：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" imap_tools "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" MailBox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" AND\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# get list of email subjects from INBOX folder")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" MailBox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'imap.mail.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("login"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test@mail.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pwd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" mailbox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    subjects "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subject "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" msg "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" mailbox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fetch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# get list of email subjects from INBOX folder - equivalent verbose version")]),s._v("\nmailbox "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MailBox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'imap.mail.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmailbox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("login"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test@mail.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pwd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" initial_folder"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'INBOX'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or mailbox.folder.set instead 3d arg")]),s._v("\nsubjects "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subject "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" msg "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" mailbox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fetch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("AND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("all")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmailbox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("logout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("文档：https://github.com/ikvk/imap_tools")]),s._v(" "),a("h2",{attrs:{id:"最后的话"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最后的话"}},[s._v("#")]),s._v(" 最后的话")]),s._v(" "),a("p",[s._v("完整示例代码："),a("a",{attrs:{href:"https://github.com/somenzz/tutorial/tree/master/email",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/somenzz/tutorial/tree/master/email"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("使用标准库有助于我们加深对邮件协议细节的理解，而三方库却可以不用考虑过多细节，直接上手，标准库相当于手动挡，三方库相当于自动挡，具体用哪个，选择最适合自己的就好。")]),s._v(" "),a("p",[s._v("推荐阅读：\n"),a("a",{attrs:{href:"https://mp.weixin.qq.com/s/8hjM_w46BxWeqcVueLXwmQ",target:"_blank",rel:"noopener noreferrer"}},[s._v("Python骚操作--邮件转微信"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);