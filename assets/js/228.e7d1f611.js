(window.webpackJsonp=window.webpackJsonp||[]).push([[228],{797:function(s,a,t){"use strict";t.r(a);var n=t(7),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("给大家看一段有趣的代码，你可以学习到装饰器、可调用类、自定义运算符、函数式编程、任意参数args 和 kwargs。")]),s._v(" "),t("p",[s._v("话不多说，先看代码：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://tva1.sinaimg.cn/large/e6c9d24egy1h1bbrlde16j21360t6jtv.jpg",alt:""}})]),s._v(" "),t("p",[s._v("要是你能一下子就看懂，那说明你已经是 Python 高手了。")]),s._v(" "),t("p",[s._v("要是没看懂，我来解说一下，我当时也是仔细研究了一番，才明白。")]),s._v(" "),t("p",[s._v("首先 F 是一个类，这个类有三个魔法函数：")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("__init__")]),s._v(" 这就是个普通的初始化函数，没啥特别的")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("__call__")]),s._v(" 当一个实例/对象被当作函数调用时，这个函数会自动调用，比如 my_f = F() ，那么 my_f(*args,**kwargs) 时就会调用这个函数。这里 "),t("code",[s._v("__call__")]),s._v(" 返回的是一个函数，因此 self.f 是一个可调用的函数。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("__gt__")]),s._v(" 这是个大于号的自定义运算符，当两个对象比较时，就会调用这个函数，比如说 "),t("code",[s._v("a > b")]),s._v(" 就相当于调用 "),t("code",[s._v("a.__gt__(b)")]),s._v("。")])])]),s._v(" "),t("p",[s._v("接下来，我们看到：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@F")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add_two")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("看到 @ 就要想到"),t("a",{attrs:{href:"https://mp.weixin.qq.com/s/krk-4eimyZyF7hXuelYmXQ",target:"_blank",rel:"noopener noreferrer"}},[s._v("装饰器"),t("OutboundLink")],1),s._v("，类 F 实现了 "),t("code",[s._v("__call__")]),s._v(" 方法，因此可以当作装饰器。")]),s._v(" "),t("p",[s._v("装饰以后，add_two 就是类 F 的对象：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" add_two\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("__main__"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("F "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("object")]),s._v(" at "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7f81cbaa7790")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("code",[s._v("add_two(i)")]),s._v(" 就相当于 "),t("code",[s._v("F(add_two).__call__(i)")])]),s._v(" "),t("p",[s._v("接下来的代码：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@F")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("divide_3_floor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("//")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("仍然是一个被装饰的函数， 装饰以后 divide_3_floor 就是类 F 的对象")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(">>> divide_3_floor\n<__main__.F object at 0x7f81cb8687f0>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("code",[s._v("divide_3_floor(i)")]),s._v(" 就相当于 `F(divide_3_floor)."),t("strong",[s._v("call")]),s._v("(i)")]),s._v(" "),t("p",[s._v("接下来的代码：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" F"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("说明 s 就是一个 F 的对象，"),t("code",[s._v("s(i)")]),s._v(" 就是 "),t("code",[s._v("s.__call__(i)")]),s._v(" 可以讲一个变量转化为字符串。")]),s._v(" "),t("p",[s._v("接下来的代码比较精彩：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("f "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" add_two "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" divide_3_floor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" s\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("要知道 a > b > c 是"),t("a",{attrs:{href:"https://mp.weixin.qq.com/s/P0PcwkWGpw-B-J0yhSe2sw",target:"_blank",rel:"noopener noreferrer"}},[s._v("链式运算符"),t("OutboundLink")],1),s._v("，展开后是 a > b and b > c， 并不是 (a>b)>c，可以参考前文"),t("a",{attrs:{href:""}})]),s._v(" "),t("p",[s._v("这里的 f，我给你展开下：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("f "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" add_two "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" divide_3_floor "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v("  divide_3_floor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" s\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("其中 "),t("code",[s._v("add_two > divide_3_floor")]),s._v(" 就会调用 "),t("code",[s._v("add_two.__gt__(divide_3_floor)")]),s._v(" 返回的就是函数：divide_3_floor(add_two(*args,**kwargs))。")]),s._v(" "),t("p",[s._v("同样的道理："),t("code",[s._v("divide_3_floor > s")]),s._v(" 返回的是 str(divide_3_floor(*args,**kwargs))")]),s._v(" "),t("p",[s._v("因此 f(7) 就是 :")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("divide_3_floor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("add_two"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("divide_3_floor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("其实就是 ：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" divide_3_floor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("add_two"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("divide_3_floor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("你看明白了吗？")]),s._v(" "),t("h2",{attrs:{id:"最后"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#最后"}},[s._v("#")]),s._v(" 最后")]),s._v(" "),t("p",[s._v("本文通过一段有趣的代码，分享了装饰器、可调用类、自定义运算符、函数式编程、任意参数 args 和 kwargs 相关的知识，如果有收获，还请给个在看，分享给更多学习 Python 的朋友。")]),s._v(" "),t("p",[s._v("推荐阅读：\n"),t("a",{attrs:{href:"https://mp.weixin.qq.com/s/8Mgk7yIiUZSYHgwwxs3wDw",target:"_blank",rel:"noopener noreferrer"}},[s._v("说说 Python 的元编程"),t("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);